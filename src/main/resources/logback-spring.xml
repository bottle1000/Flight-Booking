<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <appender name="LOKI" class="com.github.loki4j.logback.Loki4jAppender">
        <!-- Batch configuration -->
        <batchMaxItems>50</batchMaxItems>
        <batchTimeoutMs>2000</batchTimeoutMs>

        <!-- Loki HTTP sender (Java HTTP client) -->
        <http class="com.github.loki4j.logback.JavaHttpSender">
            <url>http://10.0.0.38:3101/loki/api/v1/push</url>
        </http>

        <!-- Log format and labels -->
        <format class="com.github.loki4j.logback.JsonEncoder">
            <!-- Static labels for Loki logs -->
            <label>
                <pattern>application=spring-boot-app,environment=dev</pattern>
            </label>
            <!-- Log message pattern (message and exception) -->
            <message>
                <pattern>%msg%ex</pattern>
            </message>
        </format>
    </appender>

    <!-- Send all logs (INFO and above) to the Loki appender -->
    <root level="INFO">
        <appender-ref ref="LOKI"/>
    </root>
</configuration>
